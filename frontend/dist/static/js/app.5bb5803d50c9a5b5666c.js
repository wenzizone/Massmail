webpackJsonp([1],{"8vTv":function(e,t){},MSV6:function(e,t){},NHnr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=i("7+uW"),r=i("zL8q"),s=i.n(r),a=(i("tvR6"),{render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]});var n=i("VU/8")({name:"App"},a,!1,function(e){i("8vTv")},null,null).exports,o=i("/ocq"),m={props:["menuData"],data:function(){return{activeIndex:this.$route.path}},methods:{routerChange:function(e){e.url!==this.$route.path&&router.push(e.url)}}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-menu",{attrs:{"default-active":e.activeIndex,mode:"horizontal"}},e._l(e.menuData,function(t){return i("el-menu-item",{attrs:{index:t.url},on:{click:function(i){e.routerChange(t)}}},[e._v(e._s(t.title))])}))},staticRenderFns:[]};var u={data:function(){return{menuData:[]}},created:function(){this.menuData=[{title:"发送邮件",url:"/"},{title:"查看日志",url:"/logs"}]},components:{topMenu:i("VU/8")(m,c,!1,function(e){i("MSV6")},"data-v-5b2e6dad",null).exports}},f={render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-container",[t("el-header",{attrs:{height:"auto"}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("h1",[this._v("自助邮件群发系统")])])],1),this._v(" "),t("topMenu",{ref:"topMenu",attrs:{menuData:this.menuData}})],1),this._v(" "),t("el-main",[t("router-view")],1)],1)},staticRenderFns:[]};var p=i("VU/8")(u,f,!1,function(e){i("c+BD")},null,null).exports,d=i("pFYg"),v=i.n(d),h={data:function(){return{form:{aliasName:"",fromEmail:"",smtpServer:"",port:465,password:"",varField:"",minTime:null,maxTime:null,delayTime:[],emailFiles:{varFileName:null,subjectFile:null,messageFile:null}},isVarfileDisabled:!1,varfileList:[],titlefileList:[],msgfileList:[],rules:{fromEmail:[{required:!0,message:"请输入发送人邮件地址",trigger:"blur"},{type:"email",message:"请输入正确的邮件地址",trigger:"change"}],smtpServer:[{required:!0,message:"请输入发送邮件服务器地址",trigger:"blur"}],password:[{required:!0,message:"请输入邮件服务器密码",trigger:"blur"}],varField:[{required:!0,message:"请输入邮件变量在文件中的列",trigger:"blur"}]}}},methods:{handleExceed:function(e,t){this.$message.warning("只能上传一个文件")},handleSuccess:function(e,t,i){switch(e.fileType){case"varfile":this.form.emailFiles.varFileName=e.fileName,this.varfileList=i;break;case"subjectfile":this.form.emailFiles.subjectFile=e.fileName,this.titlefileList=i;break;case"msgfile":this.form.emailFiles.messageFile=e.fileName,this.msgfileList=i}console.log("files = ",t),console.log("fileList = ",i)},checkUploadFile:function(){return 1===this.varfileList.length&&1===this.titlefileList.length&&1===this.msgfileList.length},checkDelayTime:function(){"object"===v()(this.form.minTime)&&(this.form.minTime=1),"object"===v()(this.form.maxTime)&&(this.form.maxTime=5),this.form.minTime===this.form.maxTime&&(this.from.maxTime+=1),this.form.maxTime<this.form.minTime?this.form.delayTime=[this.form.maxTime,this.form.minTime]:this.form.delayTime=[this.form.minTime,this.form.maxTime]},submitForm:function(e){var t=this;this.$refs[e].validate(function(i){return i?(t.checkDelayTime(),t.checkUploadFile()?void axios.post("/api/sendmail",QS.stringify(t.form,{arrayFormat:"brackets"})).then(function(i){t.$message.success("邮件发送提交成功，请耐心等待。。"),t.$refs[e].resetFields()}).catch(function(e){t.$message.error("邮件发送提交失败，请检查后重试。。")}):(t.$message.warning("\n            请上传 邮件变量文件，邮件主题模板文件，邮件正文模板文件。\n            "),!1)):(console.log("error submit!!"),!1)})},resetForm:function(e){this.$refs[e].resetFields()}}},_={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-form",{ref:"form",attrs:{inline:!0,model:e.form,"label-width":"190px",rules:e.rules}},[i("fieldset",[i("legend",[e._v("邮件相关信息")]),e._v(" "),i("el-form-item",{attrs:{label:"发送邮件显示名称:"}},[i("el-input",{attrs:{placeholder:"xxx营销组"},model:{value:e.form.aliasName,callback:function(t){e.$set(e.form,"aliasName",t)},expression:"form.aliasName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"发送人地址:",prop:"fromEmail"}},[i("el-input",{attrs:{placeholder:"no-reply@xxx.com"},model:{value:e.form.fromEmail,callback:function(t){e.$set(e.form,"fromEmail",t)},expression:"form.fromEmail"}})],1)],1),e._v(" "),i("fieldset",[i("legend",[e._v("发送邮件服务器信息")]),e._v(" "),i("el-form-item",{attrs:{label:"发送邮件服务器地址:",prop:"smtpServer"}},[i("el-input",{attrs:{placeholder:"smtp.xxx.com"},model:{value:e.form.smtpServer,callback:function(t){e.$set(e.form,"smtpServer",t)},expression:"form.smtpServer"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"发送邮件服务器端口:"}},[i("el-input",{attrs:{placeholder:"465"},model:{value:e.form.port,callback:function(t){e.$set(e.form,"port",t)},expression:"form.port"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"发送邮件服务器登录密码:",prop:"password"}},[i("el-input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1)],1),e._v(" "),i("fieldset",[i("legend",[e._v("邮件发送配置")]),e._v(" "),i("el-form-item",{attrs:{label:"邮件变量在文件中的列:",prop:"varField"}},[i("el-input",{attrs:{placeholder:"1,3,5,6,7"},model:{value:e.form.varField,callback:function(t){e.$set(e.form,"varField",t)},expression:"form.varField"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"每封邮件发送间隔时间:"}},[i("el-col",{attrs:{span:11}},[i("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"最小时间"},model:{value:e.form.minTime,callback:function(t){e.$set(e.form,"minTime",t)},expression:"form.minTime"}})],1),e._v(" "),i("el-col",{staticClass:"line",attrs:{span:2}},[e._v("-")]),e._v(" "),i("el-col",{attrs:{span:11}},[i("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"最大时间"},model:{value:e.form.maxTime,callback:function(t){e.$set(e.form,"maxTime",t)},expression:"form.maxTime"}})],1)],1)],1),e._v(" "),i("fieldset",[i("legend",[e._v("发送邮件所需文件")]),e._v(" "),i("el-form-item",{attrs:{label:"邮件变量文件:"}},[i("el-upload",{attrs:{limit:1,"on-exceed":e.handleExceed,name:"varFile",accept:".txt,.csv",disabled:e.isVarfileDisabled,action:"/api/upload/varfile","on-success":e.handleSuccess,"file-list":e.varfileList}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传csv/txt文件，且不超过500kb")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"邮件主题模板文件:"}},[i("el-upload",{attrs:{limit:1,name:"subjectFile",accept:".txt,.csv","on-exceed":e.handleExceed,"on-success":e.handleSuccess,action:"/api/upload/subjectile","file-list":e.titlefileList}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传csv/txt文件，且不超过100kb")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"邮件正文模板文件:"}},[i("el-upload",{attrs:{limit:1,name:"msgFile",accept:".txt,.csv","on-exceed":e.handleExceed,"on-success":e.handleSuccess,action:"/api/upload/msgfile","file-list":e.msgfileList}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传csv/txt文件，且不超过100kb")])],1)],1)],1),e._v(" "),i("el-row",[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.resetForm("form")}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("form")}}},[e._v("发送")])],1)],1)},staticRenderFns:[]};var x=i("VU/8")(h,_,!1,function(e){i("NmHh")},null,null).exports,b={render:function(){var e=this.$createElement;return(this._self._c||e)("h1",[this._v("该功能正在紧锣密鼓的开发中，敬请期待。。。。")])},staticRenderFns:[]},g=i("VU/8")(null,b,!1,null,null,null).exports;l.default.use(o.a);var F=new o.a({routes:[{path:"/",component:p,children:[{path:"",component:x,name:"sendmail"}]},{path:"/logs",component:p,children:[{path:"",component:g,name:"showlogs"}]}]}),w=i("RRJN"),T=i.n(w),y=i("mtWM"),k=i.n(y),$=i("mw3O"),S=i.n($);l.default.config.productionTip=!1,l.default.use(s.a),window.Lockr=T.a,window.axios=k.a,window.QS=S.a,window.router=F,new l.default({el:"#app",router:F,components:{App:n},template:"<App/>"})},NmHh:function(e,t){},"c+BD":function(e,t){},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.5bb5803d50c9a5b5666c.js.map